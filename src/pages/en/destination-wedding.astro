---
import BaseLayout from "../../layouts/BaseLayout.astro";
import DestinationWeddingSection from "../../components/DestinationWedding.astro";
import { getDestinationsPageData, getDestinations, getLocalized, type Language } from "../../lib/sanity";

const lang: Language = "en";
const [destinationsPage, destinations] = await Promise.all([
  getDestinationsPageData(),
  getDestinations()
]);

const langPrefix = "/en";

const getText = (field: any, fallback: string = "") => {
  if (!field) return fallback;
  return getLocalized(field, lang) || fallback;
};

const heroLabel = getText(destinationsPage?.heroLabel, "Our locations");
const heroTitle = getText(destinationsPage?.heroTitle, "Unforgettable weddings");
const heroSubtitle = getText(destinationsPage?.heroSubtitle, "in Northern Italy");
const heroText = getText(destinationsPage?.heroText, "From the charm of the Dolomites to romantic Venice, each location tells a unique story. Discover the most beautiful destinations for your dream wedding.");
const whyLabel = getText(destinationsPage?.whyLabel, "Why Northern Italy");
const whyTitle = getText(destinationsPage?.whyTitle, "One region, a thousand emotions");
const whyText = getText(destinationsPage?.whyText, "Northern Italy offers a unique variety of landscapes and atmospheres: from majestic mountains to art cities, from historic villages to enchanting hills.");
const ctaTitle = getText(destinationsPage?.ctaTitle, "Need help choosing?");
const ctaText = getText(destinationsPage?.ctaText, "Each location has its own unique character. Write to me and let's find the perfect place for your wedding together.");
const ctaButton = getText(destinationsPage?.ctaButton, "Contact me");
---

<BaseLayout
  title="Destination Wedding Italy | Weddings Veneto, Venice, Dolomites"
  description="ðŸŒŸ Dream destination weddings in UNESCO locations: Venice, Dolomites, Prosecco Hills, Venetian Villas and Bassano. Unique weddings in Italy with expert wedding planner."
  image="/og-image.jpg"
>
  <!-- Hero Section -->
  <section class="py-24 lg:py-32 bg-white">
    <div class="container mx-auto px-8 lg:px-16">
      <div class="max-w-4xl mx-auto text-center">
        <!-- Label -->
        <div class="flex items-center justify-center mb-6 fade-in">
          <div class="w-16 h-px bg-primary"></div>
          <span class="mx-4 text-xs tracking-[0.4em] text-gray-600 uppercase font-light">
            {heroLabel}
          </span>
          <div class="w-16 h-px bg-primary"></div>
        </div>

        <!-- Titolo -->
        <h1 class="text-5xl md:text-6xl lg:text-7xl font-light text-gray-900 mb-4 leading-tight fade-in fade-in-delay-1">
          {heroTitle} <br />
          <span class="text-primary italic">{heroSubtitle}</span>
        </h1>

        <!-- Descrizione -->
        {heroText && (
          <p class="text-lg md:text-xl font-light text-gray-600 leading-relaxed fade-in fade-in-delay-2">
            {heroText}
          </p>
        )}
      </div>
    </div>
  </section>

  <!-- Destinations List -->
  <DestinationWeddingSection 
    lang={lang} 
    data={null} 
    destinations={destinations} 
  />

  <!-- Why Northern Italy Section -->
  <section class="py-24 lg:py-32 bg-primary text-white relative overflow-hidden">
    <div class="absolute inset-0 opacity-5">
      <svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <pattern id="dw-pattern" x="0" y="0" width="60" height="60" patternUnits="userSpaceOnUse">
            <circle cx="30" cy="30" r="1.5" fill="white"></circle>
          </pattern>
        </defs>
        <rect width="100%" height="100%" fill="url(#dw-pattern)"></rect>
      </svg>
    </div>

    <div class="container mx-auto px-8 lg:px-16 relative">
      <div class="max-w-4xl mx-auto text-center">
        <div class="flex items-center justify-center mb-6 fade-in">
          <div class="w-16 h-px bg-white/40"></div>
          <span class="mx-4 text-xs tracking-[0.4em] uppercase font-light">
            {whyLabel}
          </span>
          <div class="w-16 h-px bg-white/40"></div>
        </div>

        <h2 class="text-4xl md:text-5xl font-light mb-8 fade-in fade-in-delay-1">
          {whyTitle}
        </h2>

        {whyText && (
          <p class="text-lg md:text-xl font-light leading-relaxed fade-in fade-in-delay-2">
            {whyText}
          </p>
        )}
      </div>
    </div>
  </section>

  <!-- Final CTA -->
  <section class="py-24 lg:py-32 bg-white">
    <div class="container mx-auto px-8 lg:px-16">
      <div class="max-w-3xl mx-auto text-center fade-in">
        <div class="flex items-center justify-center mb-8">
          <div class="w-16 h-px bg-primary"></div>
          <div class="mx-4 w-1.5 h-1.5 rounded-full bg-primary"></div>
          <div class="w-16 h-px bg-primary"></div>
        </div>

        {ctaTitle && (
          <h2 class="text-3xl md:text-4xl font-light text-gray-900 mb-6">
            {ctaTitle}
          </h2>
        )}

        {ctaText && (
          <p class="text-lg font-light text-gray-600 leading-relaxed mb-10">
            {ctaText}
          </p>
        )}

        <a
          href={langPrefix + "/contatti"}
          class="inline-flex items-center justify-center px-10 py-4 bg-primary text-white text-sm font-light tracking-wider uppercase hover:bg-secondary transition-all duration-300"
        >
          {ctaButton}
        </a>
      </div>
    </div>
  </section>
</BaseLayout>
