---
import BaseLayout from "../layouts/BaseLayout.astro";
import DestinationWeddingSection from "../components/DestinationWedding.astro";
import { getDestinationsPageData, getDestinations, getLocalized, type Language } from "../lib/sanity";

const lang: Language = "it";
const [destinationsPage, destinations] = await Promise.all([
  getDestinationsPageData(),
  getDestinations()
]);

const langPrefix = lang === "it" ? "" : `/${lang}`;

const getText = (field: any, fallback: string = "") => {
  if (!field) return fallback;
  return getLocalized(field, lang) || fallback;
};

const heroLabel = getText(destinationsPage?.heroLabel, "Le destinazioni");
const heroTitle = getText(destinationsPage?.heroTitle, "Matrimoni indimenticabili");
const heroSubtitle = getText(destinationsPage?.heroSubtitle, "nel nord Italia");
const heroText = getText(destinationsPage?.heroText, "Dal fascino delle Dolomiti alla romantica Venezia, ogni location racconta una storia unica. Scopri le destinazioni pi√π belle per il tuo matrimonio da sogno.");
const whyLabel = getText(destinationsPage?.whyLabel, "Perch√© il nord Italia");
const whyTitle = getText(destinationsPage?.whyTitle, "Una regione, mille emozioni");
const whyText = getText(destinationsPage?.whyText, "Il nord Italia offre una variet√† unica di paesaggi e atmosfere: dalle montagne maestose alle citt√† d'arte, dai borghi storici alle colline incantate.");
const ctaTitle = getText(destinationsPage?.ctaTitle, "Hai bisogno di aiuto nella scelta?");
const ctaText = getText(destinationsPage?.ctaText, "Ogni location ha il suo carattere unico. Scrivimi e troviamo insieme il posto perfetto per il tuo matrimonio.");
const ctaButton = getText(destinationsPage?.ctaButton, "Scrivimi");
---

<BaseLayout
  title="Destination Wedding Italia | Matrimoni Veneto, Venezia, Dolomiti"
  description="üåü Destination wedding da sogno in location UNESCO: Venezia, Dolomiti, Colline del Prosecco, Ville Venete e Bassano. Matrimoni unici in Italia con wedding planner esperta."
  image="/og-image.jpg"
>
  <!-- Hero Section -->
  <section class="py-24 lg:py-32 bg-white">
    <div class="container mx-auto px-8 lg:px-16">
      <div class="max-w-4xl mx-auto text-center">
        <!-- Label -->
        <div class="flex items-center justify-center mb-6 fade-in">
          <div class="w-16 h-px bg-primary"></div>
          <span class="mx-4 text-xs tracking-[0.4em] text-gray-600 uppercase font-light">
            {heroLabel}
          </span>
          <div class="w-16 h-px bg-primary"></div>
        </div>

        <!-- Titolo -->
        <h1 class="text-5xl md:text-6xl lg:text-7xl font-light text-gray-900 mb-4 leading-tight fade-in fade-in-delay-1">
          {heroTitle} <br />
          <span class="text-primary italic">{heroSubtitle}</span>
        </h1>

        <!-- Descrizione -->
        {heroText && (
          <p class="text-lg md:text-xl font-light text-gray-600 leading-relaxed fade-in fade-in-delay-2">
            {heroText}
          </p>
        )}
      </div>
    </div>
  </section>

  <!-- Destinations List - Usa lo stesso componente della home -->
  <DestinationWeddingSection 
    lang={lang} 
    data={null} 
    destinations={destinations} 
  />

  <!-- Sezione Perch√© il Nord Italia -->
  <section class="py-24 lg:py-32 bg-primary text-white relative overflow-hidden">
    <!-- Pattern -->
    <div class="absolute inset-0 opacity-5">
      <svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <pattern id="dw-pattern" x="0" y="0" width="60" height="60" patternUnits="userSpaceOnUse">
            <circle cx="30" cy="30" r="1.5" fill="white"></circle>
          </pattern>
        </defs>
        <rect width="100%" height="100%" fill="url(#dw-pattern)"></rect>
      </svg>
    </div>

    <div class="container mx-auto px-8 lg:px-16 relative">
      <div class="max-w-4xl mx-auto text-center">
        <!-- Label -->
        <div class="flex items-center justify-center mb-6 fade-in">
          <div class="w-16 h-px bg-white/40"></div>
          <span class="mx-4 text-xs tracking-[0.4em] uppercase font-light">
            {whyLabel}
          </span>
          <div class="w-16 h-px bg-white/40"></div>
        </div>

        <!-- Titolo -->
        <h2 class="text-4xl md:text-5xl font-light mb-8 fade-in fade-in-delay-1">
          {whyTitle}
        </h2>

        <!-- Testo -->
        {whyText && (
          <p class="text-lg md:text-xl font-light leading-relaxed fade-in fade-in-delay-2">
            {whyText}
          </p>
        )}
      </div>
    </div>
  </section>

  <!-- CTA Finale -->
  <section class="py-24 lg:py-32 bg-white">
    <div class="container mx-auto px-8 lg:px-16">
      <div class="max-w-3xl mx-auto text-center fade-in">
        <div class="flex items-center justify-center mb-8">
          <div class="w-16 h-px bg-primary"></div>
          <div class="mx-4 w-1.5 h-1.5 rounded-full bg-primary"></div>
          <div class="w-16 h-px bg-primary"></div>
        </div>

        {ctaTitle && (
          <h2 class="text-3xl md:text-4xl font-light text-gray-900 mb-6">
            {ctaTitle}
          </h2>
        )}

        {ctaText && (
          <p class="text-lg font-light text-gray-600 leading-relaxed mb-10">
            {ctaText}
          </p>
        )}

        <a
          href={langPrefix + "/contatti"}
          class="inline-flex items-center justify-center px-10 py-4 bg-primary text-white text-sm font-light tracking-wider uppercase hover:bg-secondary transition-all duration-300"
        >
          {ctaButton}
        </a>
      </div>
    </div>
  </section>
</BaseLayout>
