---
// Hero section Elegante - Design completamente diverso
// Layout split-screen asimmetrico con eleganza moderna
// AGGIORNATO: Ora legge i dati da Sanity CMS

import { getLocalized, getImageUrl, type Language, type HomePage } from "../lib/sanity";

interface Props {
  lang?: Language;
  data?: HomePage | null; // Dati da Sanity
}

const { lang = "it", data } = Astro.props;

// Prefisso per i link
const langPrefix = lang === "it" ? "" : `/${lang}`;

// Helper per ottenere testo localizzato con fallback
const getText = (field: any, fallback: string = "") => {
  if (!field) return fallback;
  return getLocalized(field, lang) || fallback;
};

// Testi - da Sanity se disponibili, altrimenti fallback
const heroTitle1 = getText(data?.heroTitle1, "Eleganza");
const heroTitle2 = getText(data?.heroTitle2, "Senza");
const heroTitle3 = getText(data?.heroTitle3, "Tempo");
const heroDescription = getText(data?.heroDescription, "Ogni matrimonio Ã¨ un'opera d'arte. Creo esperienze raffinate dove ogni dettaglio racconta la tua storia con classe e distinzione.");
const heroCta = getText(data?.heroCta, "Inizia il viaggio");
const heroFloatingTitle = getText(data?.heroFloatingTitle, "Tu ti sposi");
const heroFloatingSubtitle = getText(data?.heroFloatingSubtitle, "Io organizzo");

// Immagini - da Sanity se disponibili, altrimenti fallback
const defaultImages = [
  '/heroSection/hero-1.jpg',
  '/heroSection/hero-2.jpg',
  '/heroSection/hero-3.jpg'
];

const heroImages = data?.heroImages && data.heroImages.length > 0
  ? data.heroImages.map(img => getImageUrl(img, 1200))
  : defaultImages;
---

<section
  x-data={`{
        currentSlide: 0,
        slides: ${JSON.stringify(heroImages)},
        autoplay: null,
        init() {
            this.autoplay = setInterval(() => {
                this.currentSlide = (this.currentSlide + 1) % this.slides.length;
            }, 5000);
        }
    }`}
  class="relative w-full min-h-screen bg-neutral"
>
  <!-- Layout Split Screen Asimmetrico -->
  <div class="container mx-auto px-8 lg:px-16 min-h-screen flex items-center">
    <div class="grid lg:grid-cols-12 gap-0 lg:gap-16 w-full py-20 lg:py-0">
      <!-- Colonna Sinistra - Contenuto Testuale (60%) -->
      <div
        class="lg:col-span-7 flex flex-col justify-center order-2 lg:order-1"
      >
        <!-- Numero decorativo grande -->
        <div
          class="text-[180px] lg:text-[280px] font-light text-primary/5 leading-none mb-[-80px] lg:mb-[-120px] fade-in"
          style="font-variant-numeric: oldstyle-nums;"
        >
          00
        </div>

        <!-- Tagline sottile -->
        <div class="mb-6 fade-in fade-in-delay-1">
          <div class="flex items-center">
            <div class="w-12 h-px bg-primary"></div>
            <span
              class="ml-4 text-xs tracking-[0.4em] text-gray-600 uppercase font-light"
            >
              Wedding Planner
            </span>
          </div>
        </div>

        <!-- Titolo grande asimmetrico -->
        <h1
          class="text-5xl md:text-6xl lg:text-7xl xl:text-8xl font-light leading-[0.95] text-gray-900 mb-8 fade-in fade-in-delay-2"
        >
          <span class="block">{heroTitle1}</span>
          {
            heroTitle2 && (
              <span class="block text-primary italic font-normal">
                {heroTitle2}
              </span>
            )
          }
          {heroTitle3 && <span class="block">{heroTitle3}</span>}
        </h1>

        <!-- Descrizione elegante -->
        <div class="max-w-xl fade-in fade-in-delay-3">
          <p
            class="text-lg md:text-xl font-light text-gray-600 leading-relaxed mb-8"
          >
            {heroDescription}
          </p>

          <!-- Separatore elegante -->
          <div class="flex items-center my-8">
            <div class="w-16 h-px bg-primary"></div>
            <div class="mx-4 w-1 h-1 rounded-full bg-primary"></div>
            <div class="w-16 h-px bg-primary"></div>
          </div>

          <!-- CTA minimalista -->
          <a
            href={langPrefix + "/contatti"}
            class="inline-flex items-center group text-gray-900 font-light text-sm tracking-wider uppercase hover:text-primary transition-colors duration-300"
          >
            <span>{heroCta}</span>
            <svg
              class="w-6 h-6 ml-3 transform group-hover:translate-x-2 transition-transform duration-300"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="1.5"
                d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
            </svg>
          </a>
        </div>
      </div>

      <!-- Colonna Destra - Gallery Immagini (40%) -->
      <div
        class="lg:col-span-5 relative order-1 lg:order-2 mb-12 lg:mb-0 fade-in fade-in-delay-1"
      >
        <!-- Container immagini con layout elegante -->
        <div class="relative h-[60vh] lg:h-[80vh]">
          <!-- Immagine principale -->
          <div
            class="absolute top-0 right-0 w-[85%] h-[70%] overflow-hidden shadow-2xl"
          >
            <template x-for="(slide, index) in slides" :key="index">
              <div
                x-show="currentSlide === index"
                x-transition:enter="transition ease-out duration-1000"
                x-transition:enter-start="opacity-0"
                x-transition:enter-end="opacity-100"
                x-transition:leave="transition ease-in duration-1000"
                x-transition:leave-start="opacity-100"
                x-transition:leave-end="opacity-0"
                class="absolute inset-0"
              >
                <img
                  :src="slide"
                  :alt="'Elegant moment ' + (index + 1)"
                  class="w-full h-full object-cover"
                />
              </div>
            </template>

            <!-- Overlay sottile -->
            <div
              class="absolute inset-0 bg-linear-to-t from-black/20 to-transparent"
            >
            </div>
          </div>

          <!-- Elemento decorativo floating -->
          <div
            class="absolute bottom-0 left-0 w-[60%] h-[40%] bg-primary flex items-center justify-center shadow-xl"
          >
            <div class="text-center text-white p-8">
              <div
                class="text-2xl uppercase font-light mb-2"
                style="font-variant-numeric: oldstyle-nums;"
              >
                {heroFloatingTitle}
              </div>
              <div
                class="text-sm tracking-[0.3em] uppercase font-light opacity-90"
              >
                {heroFloatingSubtitle}
              </div>
            </div>
          </div>

          <!-- Linea decorativa verticale -->
          <div
            class="absolute top-1/2 left-[-2rem] transform -translate-y-1/2 w-px h-32 bg-primary/30 hidden lg:block"
          >
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Indicatori slide minimalisti verticali -->
  <div
    class="hidden lg:block absolute right-8 top-1/2 transform -translate-y-1/2 z-20"
  >
    <div class="flex flex-col space-y-4">
      <template x-for="(slide, index) in slides" :key="index">
        <button
          @click="currentSlide = index"
          class="w-px h-8 bg-gray-400/30 transition-all duration-300 relative group"
          :class="currentSlide === index ? 'bg-primary h-16' : 'hover:bg-primary/50'"
        >
          <span
            class="absolute right-4 top-1/2 transform -translate-y-1/2 text-xs text-gray-600 opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap"
            x-text="'0' + (index + 1)"></span>
        </button>
      </template>
    </div>
  </div>

  <!-- Scroll indicator elegante -->
  <div
    class="hidden lg:flex absolute bottom-8 left-1/2 transform -translate-x-1/2 flex-col items-center"
  >
    <div class="text-xs tracking-[0.3em] text-gray-500 uppercase mb-3">
      Scroll
    </div>
    <div class="w-px h-12 bg-primary/30 relative overflow-hidden">
      <div class="absolute top-0 w-full h-8 bg-primary animate-scroll"></div>
    </div>
  </div>
</section>

<style>
  @keyframes scroll {
    0% {
      transform: translateY(-100%);
    }
    100% {
      transform: translateY(100%);
    }
  }

  .animate-scroll {
    animation: scroll 2s ease-in-out infinite;
  }
</style>
