---
// Form di contatto
const services = ["Coordinamento", "Wedding Totale", "Consulenza su Misura"];
---

<section id="contatti" class="py-20 lg:py-32 bg-white">
    <div class="container mx-auto px-8 lg:px-16">
        <!-- Titolo e Descrizione -->
        <div class="text-center mb-16 lg:mb-20 fade-in">
            <h2
                class="text-4xl md:text-5xl lg:text-6xl font-light tracking-tight text-gray-900 mb-4"
            >
                CONTATTAMI
            </h2>
            <p class="text-lg md:text-xl font-light text-gray-600">
                Raccontami del tuo matrimonio, organizziamo insieme il giorno
                perfetto
            </p>
        </div>

        <!-- Form -->
        <div class="max-w-3xl mx-auto fade-in fade-in-delay-2">
            <div
                x-data="{ 
                    formData: {
                        nome: '',
                        email: '',
                        servizio: '',
                        data: '',
                        messaggio: '',
                        privacy: false
                    },
                    isSubmitting: false,
                    showSuccess: false,
                    errors: {},
                    validateField(field) {
                        this.errors[field] = false;
                    },
                    async submitForm() {
                        this.isSubmitting = true;
                        
                        // Simula invio (sostituire con chiamata API reale)
                        await new Promise(resolve => setTimeout(resolve, 1500));
                        
                        this.isSubmitting = false;
                        this.showSuccess = true;
                        
                        // Reset form dopo successo
                        setTimeout(() => {
                            this.formData = {
                                nome: '',
                                email: '',
                                servizio: '',
                                data: '',
                                messaggio: '',
                                privacy: false
                            };
                            this.showSuccess = false;
                        }, 5000);
                    }
                }"
            >
                <!-- Messaggio di Successo -->
                <div
                    x-show="showSuccess"
                    x-transition:enter="transition ease-out duration-300"
                    x-transition:enter-start="opacity-0 transform scale-95"
                    x-transition:enter-end="opacity-100 transform scale-100"
                    x-transition:leave="transition ease-in duration-200"
                    x-transition:leave-start="opacity-100 transform scale-100"
                    x-transition:leave-end="opacity-0 transform scale-95"
                    class="mb-8 p-6 bg-[#7d8b6e] text-white rounded-lg shadow-lg"
                >
                    <div class="flex items-start">
                        <svg
                            class="w-6 h-6 mr-3 flex-shrink-0 mt-0.5"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="2"
                                d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
                            ></path>
                        </svg>
                        <div>
                            <h3 class="font-medium text-lg mb-1">
                                Messaggio Inviato con Successo!
                            </h3>
                            <p class="font-light text-sm opacity-90">
                                Grazie per averci contattato. Ti risponderemo
                                entro 24 ore.
                            </p>
                        </div>
                    </div>
                </div>

                <form
                    class="space-y-6"
                    @submit.prevent="submitForm()"
                    :class="{ 'opacity-50 pointer-events-none': isSubmitting }"
                >
                    <!-- Grid per Nome ed Email -->
                    <div class="grid md:grid-cols-2 gap-6">
                        <!-- Nome -->
                        <div>
                            <label
                                for="nome"
                                class="block text-sm font-light text-gray-700 mb-2"
                            >
                                Nome e Cognome <span class="text-[#7d8b6e]"
                                    >*</span
                                >
                            </label>
                            <input
                                type="text"
                                id="nome"
                                x-model="formData.nome"
                                @input="validateField('nome')"
                                required
                                class="w-full px-4 py-3 border border-gray-300 focus:border-[#7d8b6e] focus:ring-2 focus:ring-[#7d8b6e]/20 outline-none transition-all font-light"
                                placeholder="Mario Rossi"
                                :class="{ 'border-[#7d8b6e] bg-[#7d8b6e]/5': formData.nome }"
                            />
                        </div>

                        <!-- Email -->
                        <div>
                            <label
                                for="email"
                                class="block text-sm font-light text-gray-700 mb-2"
                            >
                                Email <span class="text-[#7d8b6e]">*</span>
                            </label>
                            <input
                                type="email"
                                id="email"
                                x-model="formData.email"
                                @input="validateField('email')"
                                required
                                class="w-full px-4 py-3 border border-gray-300 focus:border-[#7d8b6e] focus:ring-2 focus:ring-[#7d8b6e]/20 outline-none transition-all font-light"
                                placeholder="mario.rossi@email.com"
                                :class="{ 'border-[#7d8b6e] bg-[#7d8b6e]/5': formData.email }"
                            />
                        </div>
                    </div>

                    <!-- Grid per Servizio e Data -->
                    <div class="grid md:grid-cols-2 gap-6">
                        <!-- Servizio -->
                        <div>
                            <label
                                for="servizio"
                                class="block text-sm font-light text-gray-700 mb-2"
                            >
                                Servizio <span class="text-[#7d8b6e]">*</span>
                            </label>
                            <select
                                id="servizio"
                                x-model="formData.servizio"
                                @change="validateField('servizio')"
                                required
                                class="w-full px-4 py-3 border border-gray-300 focus:border-[#7d8b6e] focus:ring-2 focus:ring-[#7d8b6e]/20 outline-none transition-all font-light bg-white"
                                :class="{ 'border-[#7d8b6e] bg-[#7d8b6e]/5': formData.servizio }"
                            >
                                <option value="" disabled selected
                                    >Seleziona un servizio</option
                                >
                                {
                                    services.map((service) => (
                                        <option value={service}>
                                            {service}
                                        </option>
                                    ))
                                }
                            </select>
                        </div>

                        <!-- Data Matrimonio -->
                        <div>
                            <label
                                for="data"
                                class="block text-sm font-light text-gray-700 mb-2"
                            >
                                Data del Matrimonio <span class="text-[#7d8b6e]"
                                    >*</span
                                >
                            </label>
                            <input
                                type="date"
                                id="data"
                                x-model="formData.data"
                                @input="validateField('data')"
                                required
                                class="w-full px-4 py-3 border border-gray-300 focus:border-[#7d8b6e] focus:ring-2 focus:ring-[#7d8b6e]/20 outline-none transition-all font-light"
                                :class="{ 'border-[#7d8b6e] bg-[#7d8b6e]/5': formData.data }"
                            />
                        </div>
                    </div>

                    <!-- Messaggio -->
                    <div>
                        <label
                            for="messaggio"
                            class="block text-sm font-light text-gray-700 mb-2"
                        >
                            Messaggio <span class="text-[#7d8b6e]">*</span>
                        </label>
                        <textarea
                            id="messaggio"
                            x-model="formData.messaggio"
                            @input="validateField('messaggio')"
                            required
                            rows="6"
                            class="w-full px-4 py-3 border border-gray-300 focus:border-[#7d8b6e] focus:ring-2 focus:ring-[#7d8b6e]/20 outline-none transition-all font-light resize-none"
                            placeholder="Raccontaci del vostro matrimonio, delle vostre esigenze e come possiamo aiutarvi..."
                            :class="{ 'border-[#7d8b6e] bg-[#7d8b6e]/5': formData.messaggio }"
                        ></textarea>
                        <div
                            class="text-xs text-gray-500 mt-1 text-right"
                            x-show="formData.messaggio.length > 0"
                        >
                            <span x-text="formData.messaggio.length"></span> caratteri
                        </div>
                    </div>

                    <!-- Privacy Checkbox -->
                    <div class="flex items-start">
                        <input
                            type="checkbox"
                            id="privacy"
                            x-model="formData.privacy"
                            required
                            class="mt-1 w-5 h-5 border-gray-300 text-[#7d8b6e] focus:ring-[#7d8b6e] cursor-pointer transition-all"
                        />
                        <label
                            for="privacy"
                            class="ml-3 text-sm font-light text-gray-600 leading-relaxed cursor-pointer"
                        >
                            Acconsento al trattamento dei miei dati personali
                            secondo la <a
                                href="/privacy"
                                class="text-[#7d8b6e] hover:underline"
                                >Privacy Policy</a
                            >. <span class="text-[#7d8b6e]">*</span>
                        </label>
                    </div>

                    <!-- Pulsante Invio -->
                    <div class="pt-4">
                        <button
                            type="submit"
                            class="w-full md:w-auto px-12 py-4 bg-[#7d8b6e] text-white font-light tracking-wider uppercase hover:bg-[#6d7a5e] transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed relative overflow-hidden"
                            :disabled="!formData.privacy || isSubmitting"
                        >
                            <span
                                x-show="!isSubmitting"
                                class="flex items-center justify-center"
                            >
                                Invia Messaggio
                            </span>
                            <span
                                x-show="isSubmitting"
                                class="flex items-center justify-center"
                            >
                                <svg
                                    class="animate-spin h-5 w-5 mr-3"
                                    xmlns="http://www.w3.org/2000/svg"
                                    fill="none"
                                    viewBox="0 0 24 24"
                                >
                                    <circle
                                        class="opacity-25"
                                        cx="12"
                                        cy="12"
                                        r="10"
                                        stroke="currentColor"
                                        stroke-width="4"></circle>
                                    <path
                                        class="opacity-75"
                                        fill="currentColor"
                                        d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                                    ></path>
                                </svg>
                                Invio in corso...
                            </span>
                        </button>
                    </div>

                    <!-- Note -->
                    <p class="text-sm font-light text-gray-500 italic">
                        * Campi obbligatori
                    </p>
                </form>
            </div>
        </div>
    </div>
</section>
